# Master Table

Master table will the main table where all of the data types will be joined together and made into one cohesive data type. The schema will probably be evergreen as we encounter different data types from other states, so this document will be evergreen as well.

In this document it will list all the data sources from different state/federal, also the decision process on why the data type is chosen. This document should reflect what's the current master data type on the repository as well.

## Data Type

### Individual Contributions

At the end all of the data will get merged into `master_individual_contributions`.

| Source | Source Tables | Remark |
| --------------- | --------------- | --------------- |
| FEC (federal) | `federal_individual_contributions_landing` | This source probably going to be the main anchor for all of the other sources for the master schema. |
| VA (Virginia state) | `schedulea_new_landing`, `schedulea_transitional_landing`, `schedulea_old_landing` | Several table with different schema (see [Virginia ingest asset](./contributions_pipeline/ingestion/states/virginia/assets.py) for the timeline for each schema). |
| CA (California state) | `RCPT` | Based on the [documentations](https://www.sos.ca.gov/campaign-lobbying/helpful-resources/raw-data-campaign-finance-and-lobbying-activity) provided, `RCPT` is Form 401 (Slate Mailer Organization Statement) Schdule A (Payments Received), also Form 460 (Recipient Committee Campaign Statement) Schedule A (Monetary Contributions), Schedule C (Non-monetary Contributions), Schedule I (Misc. Increase), also Form 496 (Late Independent Expenditure Report) P3 (Contributions $100 or more). For the sake of correctness, we will filter only the Schedule A rows. |

#### Master Schema

Current master schema for the data type will be as follows.

| Column Name | Data Type | Nullable | Remarks |
| --------------- | --------------- | --------------- | --------------- |
| `id` | bigint | NO | Generated unique id for our own use cases. Generated by incrementing the id. |
| `source` | text | NO | Initial source of data (e.g. `FEC`, `VA`, `CA`, etc) |
| `source_id` | text | YES | Unique id from the source data to identify duplicates |
| `committee_id` | text | NO | Id to reference to committee master table, could comes from orignal data (with state/federal prefix on the id) |
| `candidate_id` | text | YES | Candidate id prefixed with the state source. |
| `candidate_name` | text | YES | Full name of the candidate related to the contribution. |
| `name` | text | NO | Combined first and last name, as FEC only gives singular name |
| `city` | text | YES | Contributors city |
| `state` | text | YES | Contributors state |
| `zip_code` | text | NO | Contributors zip code |
| `employer` | text | YES | Contributors employer name |
| `occupation` | text | YES | Occupation of the contributors |
| `amount` | decimal | NO | The amount of contributions, 7 digit precision, 2 digit scale as most contributions maximum is >$1,000,000.00 |
| `contribution_datetime` | timestamptz | NO | Time the contributions was made |
| `insert_datetime` | timestamp | NO | Time the row was added in UTC time zone, defaults to `CURRENT_TIMESTAMP`. |

On FEC and CA table there could be amendment to the original contributions filing. For now it will be ignored.

### Committee Master

At the end all of the data source will be merged into `master_committee`. In this master table, all type of committee, and PACs are just going to be clumped together into one as a master table.

| Source | Source Tables | Remark |
| --------------- | --------------- | --------------- |
| FEC (federal) | `federal_committee_master_landing` | This source probably going to be the main anchor for all of the other sources for the master schema. |
| VA (Virginia state) | `report_landing` | Contains the committee data, with their id, affiliation, etc |
| CA (California state) | `CVR2_CAMPAIGN_DISCLOSURE` | Based on the [documentations](https://www.sos.ca.gov/campaign-lobbying/helpful-resources/raw-data-campaign-finance-and-lobbying-activity) provided, this table provides data for a lot of different forms, but handles the committee data. |

#### Master Schema

Current master schema for the data type will be as follows.

| Column Name | Data Type | Nullable | Remarks |
| --------------- | --------------- | --------------- | --------------- |
| `source` | text | NO | Initial source of data (e.g. `FEC`, `VA`, `CA`, etc) |
| `committee_id` | text | NO | Unique id from the source data (with state/federal prefix) to identify the committee itself |
| `candidate_id` | text | YES | Unique id from the source data (with state/federal prefix) to identify the candidate related to this committee |
| `committee_designation` | text | YES | Whenever possible to identify, use A = authorized by candidate, B = Lobbyist/Registrant PAC, D = Leadership PAC, J = Joint fundraiser, P = principal campaign comittee of candidate, U = unauthorized. This part mostly comes from FEC data type |
| `name` | text | NO | Name of the committee |
| `address1` | text | YES | First line of the committee address |
| `address2` | text | YES | Second line of the address |
| `city` | text | YES | Committee city location |
| `state` | text | YES | Committee state |
| `zip_code` | text | YES | Committee zip code |
| `affiliation` | text | YES | Party affliation for the committee, not available on CA |
| `district` | text | YES | District of the election the committee is, only available on states. District could not be number as in VA, district could be text (e.g. `Election - JAMESTOWN DISTRICT`) |
| `insert_datetime` | timestamp | NO | Time the row was added in UTC time zone, defaults to `CURRENT_TIMESTAMP`. |

On CA table there could be a amendment to the committee filing, which will be ignored.

### Candidate Master

Candidate different from Committee, it should point to one exact person (or tried to). Each candidate will probably have a new committee every year, thus later on we will probably have a way to relate candidate with their committee.

#### Master Schema

| Column Name | Data Type | Nullable | Remarks |
| --------------- | --------------- | --------------- | --------------- |
| `source` | text | NO | Initial source of data (e.g. `FEC`, `VA`, `CA`, etc) |
| `candidate_id` | text | NO | Unique candidate id prefixed with the state source. |
| `name` | text | NO | Full name of the candidate itself |
| `affiliation` | text | YES | Party affliation of the candidate |
| `insert_datetime` | timestamp | NO | Time the row was added in UTC time zone, defaults to `CURRENT_TIMESTAMP`. |
